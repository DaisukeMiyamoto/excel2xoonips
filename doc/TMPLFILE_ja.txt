XML テンプレートファイルの書式について

1. XML テンプレートファイルの役割
　XML テンプレートファイルは，XooNIps のインポートデータ用の XML ファイル
の雛型のファイルです．
　プログラム実行時に入力された Excel の Sheet 名に対応する tmpl ファイル
(シート名).tmpl が自動で読み込まれます．
　プログラムの内部では入力された  Excel 表の横列毎に INI ファイルで定義さ
れた変数と書式に従い，XML テンプレートファイルで置換されインポート用の XML
ファイルとして出力されます．

2. 書式
　XML テンプレートファイルにはアイテムタイプ毎のインポート用の XML ファイル
の雛型を記述します．
　変数は <{$ と }> のタグで囲みます(例 <{$variable}> )．システムはこの
タグ <{$...}> を目印 に INI ファイルで定義された変数と置換します．例え
ば <{$variable}> のタグは INI ファイル無いに定義された variable 変数の
カラムのデータに変換されます．このとき variable は任意の文字列です．

3. 予約済み定義変数
　XML テンプレートファイルには，システムが自動で設定する値として以下の
変数が予約されています．

  <{$system.item_id}>
     - Excel 表から XML データを出力する際，Excel ファイル内の全データ
       の通し番号を順に置換します．

  <{$system.itemtype}>
     - アイテムタイプ名(モジュールディレクトリ名) に置換します．

  <{$system.now}>
     - プログラム実行時の日時(ISO8601準拠の文字列)に置換します．

4. 拡張書式
4.1. データセット領域 dataset
　複数のセルの配列データを配列個数分繰り返しテンプレートに置換したい場合に
データセット領域を利用することができます．

  以下の様な拡張書式を用います．

　<{dataset $group}>
  <group>
    <data><{$data}></data>
    <name><{$name}></name>
  </group>
  <{/dataset}>

  ここで $group はデータセット領域名，$data, $name 領域内フィールド名を表し
ます．ini ファイル内で領域内フィールド名を指定したセルのデータタイプとして
dataset の指定がされている場合，対応するデータセット領域名の
<{dataset $group}>〜<{/dataset}> の中身が Excel 表のセルの配列回数分置換され
ます．

4.2. 行セット領域 rowset
  複数の行のデータを一つのテンプレートに置換する場合に利用します．

  以下の様な拡張書式を用います．

　<{rowset}>
  <index parent_id="<{$parent_id}>" id="<{$index_id}>">
    <title><{$title}></title>
  </index>
  <{/rowset}>

  この機能は，試験的に実装されたインデックスの変換に利用しており，アイテム
には利用できません． 

